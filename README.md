# 🚀 LLM 우선 네이버 블로그 감성 분석기 (GradioNaverSentiment)

![Python](https://img.shields.io/badge/Python-3.9%2B-blue?style=flat-square&logo=python)
![Gradio](https://img.shields.io/badge/Gradio-4.0%2B-orange?style=flat-square&logo=gradio)
![LangChain](https://img.shields.io/badge/LangChain-0.1%2B-green?style=flat-square&logo=langchain)
![LangGraph](https://img.shields.io/badge/LangGraph-0.0%2B-red?style=flat-square&logo=langgraph)
![Selenium](https://img.shields.io/badge/Selenium-4.0%2B-purple?style=flat-square&logo=selenium)

## 🌟 프로젝트 소개

**GradioNaverSentiment**는 네이버 블로그 리뷰의 감성을 심층적으로 분석하는 지능형 웹 애플리케이션입니다. 사용자는 특정 **키워드**나 **카테고리**를 통해 원하는 주제의 후기들을 분석하고, 그 결과를 다각적인 시각 자료와 데이터로 확인할 수 있습니다. 

특히 이 프로젝트는 **LLM 우선 아키텍처**를 채택하여 단순한 단어 매칭을 넘어, 문장의 전체적인 문맥과 뉘앙스를 파악하는 데 중점을 둡니다. 또한, 대규모 코드 리팩토링을 통해 **클린 아키텍처(Clean Architecture)**를 도입하여 기능의 확장과 유지보수가 용이한 안정적인 구조를 갖추고 있습니다.

## 🚀 주요 기능 업데이트 (v2.0)

### 1. 주체 기반 감성 워드 클라우드 (Aspect-Based Sentiment Word Cloud)

단순히 단어의 '언급 빈도'만 보여주던 기존 워드 클라우드를 완전히 새로운 방식으로 개선했습니다.

- **Before**: '좋다', '나쁘다' 등 감성 표현 자체의 빈도수를 시각화
- **After**: **'무엇이' 좋고 나빴는지**를 직관적으로 보여주는 '주체' 기반 시각화

이제 모든 분석에서 **긍정/부정 2개의 워드 클라우드**가 생성됩니다.
- **[긍정] 워드 클라우드 (파란색 계열)**: '음식', '분위기', '공연' 등 긍정적 평가를 받은 '주체'들을 보여줍니다. 해당 주체와 관련된 긍정 점수가 높을수록 단어가 크게 표시됩니다.
- **[부정] 워드 클라우드 (붉은색 계열)**: '주차', '가격', '대기시간' 등 부정적 평가를 받은 '주체'들을 보여줍니다. 해당 주체와 관련된 부정 점수가 높을수록 단어가 크게 표시됩니다.

이를 통해 사용자는 분석 대상의 어떤 속성이 긍정적/부정적 여론의 핵심인지를 한눈에 파악할 수 있습니다.

### 2. 자유 그룹 비교 분석 기능

기존의 '카테고리 선택 축제 비교' 탭을 사용자의 피드백을 반영하여 훨씬 더 강력하고 유연한 **'자유 그룹 비교 분석'** 탭으로 완전히 개편했습니다.

- **최대 4개 그룹 동시 비교**: 최대 4개의 '축제 그룹'을 각각 설정하고, 그 결과를 나란히 비교 분석할 수 있습니다.
- **자유로운 그룹 구성**: 각 그룹은 아래 두 가지 방식으로 자유롭게 구성할 수 있습니다.
  1. **카테고리 단위 선택**: '대분류', '중분류', '소분류'를 선택하여 해당 카테고리에 속한 모든 축제를 하나의 그룹으로 지정
  2. **축제 직접 선택**: 특정 카테고리 내의 축제 목록에서, 원하는 축제들만 **다중 선택(Multi-select)**하여 커스텀 그룹을 구성
- **통합 리포트**: 각 그룹의 분석 결과는 '카테고리별 분석'과 동일한 종합 리포트 형식으로 제공됩니다.

이제 사용자는 `'여름 축제 그룹' vs '겨울 축제 그룹' vs '내가 직접 고른 록 페스티벌 그룹'` 과 같은 고차원적인 비교 분석을 손쉽게 수행할 수 있습니다.

---

## ✨ 기존 주요 기능

### 1. 4가지 강력한 분석 모드
사용자의 필요에 따라 유연하게 분석 방식을 선택할 수 있습니다.
*   **단일 키워드 분석**: 특정 키워드(예: `제주도 핫플`)에 대한 여론을 심층 분석합니다.
*   **키워드 비교 분석**: 두 키워드에 대한 여론을 나란히 놓고 비교합니다.
*   **카테고리별 분석**: `자연과계절 > 벚꽃 > 벚꽃 · 벚꽃길`처럼 세분화된 카테고리를 선택하여, 관련 축제 그룹 전체의 감성을 종합적으로 분석합니다.
*   **자유 그룹 비교 분석**: **(New!)** 최대 4개의 축제 그룹을 구성하여 그룹 간 비교 분석을 수행합니다. 각 그룹은 카테고리 전체 또는 직접 선택한 여러 축제로 구성할 수 있습니다.

### 2. 한눈에 보는 상세 분석 리포트
분석 결과는 사용자가 쉽게 인사이트를 얻을 수 있도록 다양한 형태로 제공됩니다.
*   **종합 분석**: 전체 긍/부정 비율을 도넛 차트로 시각화합니다.
*   **계절별 분석**: 후기를 `봄/여름/가을/겨울`로 나누어 계절별 감성 경향을 비교합니다.
*   **주체 기반 워드 클라우드**: **(New!)** 긍정/부정 여론의 핵심 '주체'가 무엇인지 시각적으로 보여줍니다.
*   **부정 의견 요약**: LLM이 모든 부정적 리뷰를 분석하여 **핵심 불만 사항**을 목록 형태로 요약합니다.
*   **상세 결과 테이블**: 분석에 사용된 **모든 블로그 리뷰**의 상세 내용과 **축제별 요약**을 표 형태로 제공하며, 페이지네이션을 지원합니다.

### 3. 모든 결과의 CSV 다운로드
화면에 표시되는 **모든 종류의 데이터**를 각각의 **CSV 파일로 다운로드**할 수 있습니다.

### 4. LLM 기반의 지능형 분석 엔진
`LangGraph`를 활용한 에이전트 시스템이 분석의 정확성과 깊이를 더합니다.
*   **지능형 컨텐츠 검증**: LLM이 사용자의 검색 의도와 일치하는 '진짜 후기'인지 사전 검증합니다.
*   **주체-감성 동시 추출**: **(New!)** LLM이 문맥을 파악하여 '감성'과 그 '주체'를 쌍으로 추출합니다.
*   **자체 피드백 및 동적 학습**: 분석 결과의 불일치를 스스로 감지하여 재요약하고, 새로운 감성 표현을 발견하면 사전에 동적으로 추가하며 학습합니다.

## 🏗️ 아키텍처 설명

### 1. 클린 아키텍처 (Clean Architecture)

프로젝트 전체가 클린 아키텍처 원칙에 따라 리팩토링되었습니다. 코드는 역할과 의존성 방향에 따라 `src` 폴더 내의 `domain`, `application`, `infrastructure`, `presentation` 레이어로 명확하게 분리되어, 코드의 결합도는 낮추고 응집도는 높인 유연한 구조를 갖추고 있습니다.

```
C:\Users\SBA\github\GradioNaverSentiment\
└── src
    ├── application/     # 애플리케이션의 핵심 비즈니스 로직 (Use Cases)
    ├── data/            # 데이터 로딩 및 관리
    ├── domain/          # 핵심 도메인 모델 (Entities)
    ├── infrastructure/  # 외부 서비스/라이브러리와의 연동 (DB, API, Scraper)
    └── presentation/    # 사용자 인터페이스 (UI)
```

### 2. 분석 워크플로우

본 애플리케이션의 분석 과정은 두 단계의 워크플로우로 구성됩니다.

**A. 상위 워크플로우: 분석 총괄**

사용자가 UI에서 분석을 시작하면, `Service Layer`가 전체 분석 과정을 조율합니다. 카테고리 분석의 경우, 해당 카테고리의 모든 축제에 대해 B 워크플로우를 반복 호출하고 결과를 취합합니다.

```mermaid
graph TD
    subgraph "UI Layer"
        A[1. 사용자, 분석 시작]
    end
    subgraph "Service Layer (Orchestrator)"
        B[2. 분석 요청 접수]
        C[3. Loop: 분석 대상 목록 반복]
        D{4. 개별 대상 분석 요청}
        E[6. 모든 결과 취합 및 종합]
    end
    subgraph "Core Workflow (per Item)"
        F[5. B. 개별 아이템 분석 워크플로우]
    end
    subgraph "UI Layer"
        G[7. 최종 결과 표시]
    end
    A --> B --> C --> D --> F --> D --> C --> E --> G
```

**B. 핵심 워크플로우: 단일 블로그 분석 (LangGraph)**

개별 블로그 포스트 하나를 분석하는 핵심 로직입니다. `LangGraph` 기반의 에이전트들이 "검증 → 주체/감성 추출 → 채점"의 파이프라인을 수행하며, 자체 피드백 루프를 통해 분석의 정확도를 높입니다. (Summarizer가 Aspect Extractor로 역할 변경)

```mermaid
graph TD
    A[블로그 본문] --> B(Content Validator);
    B --> C{주제 관련성?};
    C -- 관련 없음 --> D[분석 중단];
    C -- 관련 있음 --> E(LLM Aspect Extractor);
    E --> F(Rule Scorer);
    F --> G{점수-감성 일치?};
    G -- No --> H[피드백과 함께 재추출 요청];
    H --> E;
    G -- Yes --> I{신규 감성 단어?};
    I -- Yes --> J(Dynamic Scorer: 사전 학습);
    J --> F;
    I -- No --> K[분석 결과 확정];
```

## ⚙️ 설치 및 실행 방법

### 1. 환경 설정

프로젝트 루트 디렉토리에 `.env` 파일을 생성하고 아래와 같이 API 키를 설정합니다.

```
NAVER_CLIENT_ID=YOUR_NAVER_CLIENT_ID
NAVER_CLIENT_SECRET=YOUR_NAVER_CLIENT_SECRET
NAVER_TREND_CLIENT_ID=YOUR_NAVER_TREND_CLIENT_ID
NAVER_TREND_CLIENT_SECRET=YOUR_NAVER_TREND_CLIENT_SECRET
GOOGLE_API_KEY=YOUR_GOOGLE_API_KEY
```

### 2. 의존성 설치

Python 3.9 이상 환경에서 필요한 라이브러리를 설치합니다.

```bash
pip install -r requirements.txt
```

### 3. 애플리케이션 실행

```bash
python app_llm.py
```

터미널에 출력되는 URL(일반적으로 `http://127.0.0.1:7860`)로 접속하여 웹 UI를 사용할 수 있습니다.

## 🚀 활용 방법

1.  **분석 탭 선택**: 상단의 탭 중 원하는 분석 방식을 선택합니다.
2.  **대상 입력**:
    - `단일/비교 분석`: 키워드를 입력합니다.
    - `카테고리별 분석`: 분석할 카테고리를 `대분류`부터 순서대로 선택합니다.
    - `자유 그룹 비교 분석`: 각 그룹(A,B,C,D)별로 카테고리를 선택하거나, 축제를 직접 다중 선택합니다. (카테고리만 선택 시 해당 카테고리 전체 분석)
3.  **분석 시작**: `분석 시작` 버튼을 클릭하여 분석을 실행합니다.
4.  **결과 확인 및 다운로드**:
    - 분석이 완료되면 종합 분석 결과와 상세 테이블이 화면에 표시됩니다.
    - 각 결과물 옆에 있는 **다운로드 버튼**을 클릭하여 원하는 데이터를 CSV 파일로 저장할 수 있습니다.
5.  **(선택) 상세 로그 확인**: 에이전트의 자세한 작동 과정이 궁금하다면, '상세 로그 출력' 체크박스를 선택하고 분석을 실행하세요. 터미널에 모든 처리 과정이 출력됩니다.

## 시연 영상

**Part 1**
<img src="videos/demo-part-1.gif" alt="시연 영상 1" style="max-width: 1460px;">

**Part 2**
<img src="videos/demo-part-2.gif" alt="시연 영상 2" style="max-width: 1460px;">
